<div class="edit-pet-container">
  <p-card header="Edit Pet" class="edit-pet-card">
    <div class="card-content" *ngIf="!loading; else loadingTemplate">
      <form [formGroup]="petForm" (ngSubmit)="onSubmit()" class="pet-form">
        <!-- Basic Information Section -->
        <div class="form-section">
          <h3>Basic Information</h3>

          <div class="form-row">
            <div class="form-field">
              <label for="name">Pet Name *</label>
              <input
                pInputText
                id="name"
                formControlName="name"
                placeholder="Enter pet name"
                class="capitalize"
                [class.ng-invalid]="isFieldInvalid('name')"
              />
              <small class="error-message" *ngIf="isFieldInvalid('name')">
                {{ getFieldError("name") }}
              </small>
            </div>

            <div class="form-field">
              <label for="species">Species *</label>
              <p-select
                formControlName="species"
                optionLabel="label"
                optionValue="value"
                placeholder="Select species"
                [options]="speciesOptions"
                [class.ng-invalid]="isFieldInvalid('species')"
              ></p-select>
              <small class="error-message" *ngIf="isFieldInvalid('species')">
                {{ getFieldError("species") }}
              </small>
            </div>
          </div>

          <div class="form-row">
            <div class="form-field">
              <label for="breed">Breed *</label>
              <input
                pInputText
                id="breed"
                formControlName="breed"
                placeholder="Enter breed"
                class="capitalize"
                [class.ng-invalid]="isFieldInvalid('breed')"
              />
              <small class="error-message" *ngIf="isFieldInvalid('breed')">
                {{ getFieldError("breed") }}
              </small>
            </div>

            <div class="form-field">
              <label for="gender">Gender *</label>
              <p-select
                formControlName="gender"
                [options]="genderOptions"
                optionLabel="label"
                optionValue="value"
                placeholder="Select gender"
                [class.ng-invalid]="isFieldInvalid('gender')"
              ></p-select>
              <small class="error-message" *ngIf="isFieldInvalid('gender')">
                {{ getFieldError("gender") }}
              </small>
            </div>
          </div>

          <div class="form-row">
            <div class="form-field">
              <label for="dateOfBirth">Date of Birth *</label>
              <p-datepicker
                formControlName="dateOfBirth"
                [showIcon]="true"
                placeholder="Select date of birth"
                [class.ng-invalid]="isFieldInvalid('dateOfBirth')"
              ></p-datepicker>
              <small
                class="error-message"
                *ngIf="isFieldInvalid('dateOfBirth')"
              >
                {{ getFieldError("dateOfBirth") }}
              </small>
            </div>

            <div class="form-field">
              <label for="color">Color/Markings</label>
              <input
                pInputText
                id="color"
                formControlName="color"
                placeholder="Enter color or markings"
              />
            </div>
          </div>
        </div>

        <!-- Physical Information Section -->
        <div class="form-section">
          <h3>Physical Information</h3>

          <div class="form-row">
            <div class="form-field">
              <label for="weight">Weight (kg)</label>
              <p-inputNumber
                formControlName="weight"
                mode="decimal"
                [minFractionDigits]="1"
                [maxFractionDigits]="2"
                [min]="0"
                placeholder="Enter weight"
              ></p-inputNumber>
            </div>

            <div class="form-field">
              <label for="adoptionFee">Adoption Fee ($) *</label>
              <p-inputNumber
                formControlName="adoptionFee"
                mode="currency"
                currency="AUD"
                [min]="0"
                placeholder="Enter adoption fee"
                [class.ng-invalid]="isFieldInvalid('adoptionFee')"
              ></p-inputNumber>
              <small
                class="error-message"
                *ngIf="isFieldInvalid('adoptionFee')"
              >
                {{ getFieldError("adoptionFee") }}
              </small>
            </div>
          </div>
        </div>

        <!-- Health & Behavior Section -->
        <div class="form-section">
          <h3>Health & Behavior</h3>

          <div class="checkbox-group">
            <div class="checkbox-item">
              <p-checkbox
                formControlName="isSpayedNeutered"
                [binary]="true"
                inputId="isSpayedNeutered"
              ></p-checkbox>
              <label for="isSpayedNeutered">Spayed/Neutered</label>
            </div>

            <div class="checkbox-item">
              <p-checkbox
                formControlName="isHouseTrained"
                [binary]="true"
                inputId="isHouseTrained"
              ></p-checkbox>
              <label for="isHouseTrained">House Trained</label>
            </div>

            <div class="checkbox-item">
              <p-checkbox
                formControlName="isGoodWithKids"
                [binary]="true"
                inputId="isGoodWithKids"
              ></p-checkbox>
              <label for="isGoodWithKids">Good with Kids</label>
            </div>

            <div class="checkbox-item">
              <p-checkbox
                formControlName="isGoodWithPets"
                [binary]="true"
                inputId="isGoodWithPets"
              ></p-checkbox>
              <label for="isGoodWithPets">Good with Other Pets</label>
            </div>
          </div>
        </div>

        <!-- Status & Notes Section -->
        <div class="form-section">
          <h3>Status & Notes</h3>

          <div class="form-field">
            <label for="status">Status *</label>
            <p-select
              formControlName="status"
              [options]="statusOptions"
              optionLabel="label"
              optionValue="value"
              placeholder="Select status"
              [class.ng-invalid]="isFieldInvalid('status')"
            ></p-select>
            <small class="error-message" *ngIf="isFieldInvalid('status')">
              {{ getFieldError("status") }}
            </small>
          </div>

          <div class="form-field">
            <label for="description">Description *</label>
            <p-editor
              formControlName="description"
              [style]="{ height: '150px' }"
              placeholder="Enter pet description"
              [class.ng-invalid]="isFieldInvalid('description')"
            ></p-editor>
            <small class="error-message" *ngIf="isFieldInvalid('description')">
              {{ getFieldError("description") }}
            </small>
          </div>

          <div class="form-field">
            <label for="specialNeeds">Special Needs/Medical Conditions</label>
            <p-editor
              formControlName="specialNeeds"
              [style]="{ height: '100px' }"
              placeholder="Enter any special needs or medical conditions"
            ></p-editor>
          </div>
        </div>

        <!-- Image Upload Section -->
        <div class="form-section">
          <h3>Pet Image</h3>
          <p-fileUpload
            mode="basic"
            chooseLabel="Choose Image"
            accept="image/*"
            [maxFileSize]="5000000"
            (onSelect)="onImageUpload($event)"
            [auto]="false"
          ></p-fileUpload>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions">
          <p-button
            label="Cancel"
            severity="secondary"
            (onClick)="onCancel()"
            [disabled]="saving"
          ></p-button>

          <p-button
            label="Save Changes"
            type="submit"
            [loading]="saving"
            [disabled]="petForm.invalid"
          ></p-button>
        </div>
      </form>
    </div>

    <ng-template #loadingTemplate>
      <div class="loading-container">
        <p-progressSpinner></p-progressSpinner>
        <p>Loading pet information...</p>
      </div>
    </ng-template>
  </p-card>
</div>

<p-toast></p-toast>
